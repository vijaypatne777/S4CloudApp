sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","../model/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageToast","sap/m/MessagePopover","sap/m/MessageItem","sap/m/Button","sap/m/MessageBox","sap/ui/export/Spreadsheet","sap/ui/core/util/ExportTypeCSV"],function(e,t,r,a,n,i,o,s,c,l,d,u){"use strict";var g;return e.extend("CreditDebit.UploadCreditDebitMemo.controller.Worklist",{formatter:r,onInit:function(){var e=this.byId("cRB");var t=this.byId("dRB");var r=this.byId("rgM");var a=r.getSelectedIndex();this._cIndex=a;if(this._cIndex===0){var n=this.byId("myContainer");var i=sap.ui.xmlfragment(this.createId("cmF"),"CreditDebit.UploadCreditDebitMemo.view.CreditMemo",this);this._cmF=i;n.addContent(i)}this._tModel=new sap.ui.model.json.JSONModel;this._rModel=new sap.ui.model.json.JSONModel;this._dModel=this.getOwnerComponent().getModel("dMemo");this._cModel=this.getOwnerComponent().getModel();this._oPromises=[];this._msgArr=[];this._aObj=[];this._msgData={msgs:this._msgArr};this._rData={trec:this._aObj};var o=this.byId("cUpload");o.setEnabled(false)},onUpdateFinished:function(e){},onPress:function(e){},onShareInJamPress:function(){},onSearch:function(e){},onRefresh:function(){},_showObject:function(e){},_applySearch:function(e){},handleUploadPress:function(){var e=this;var t;var r=[];var a={trec:r};var n=this.byId("fileUploader");if(this._cIndex===0){t=this.byId(sap.ui.core.Fragment.createId("cmF","memoTable"))}if(this._cIndex===1){t=this.byId(sap.ui.core.Fragment.createId("dmF","memoTable"))}var o=[];o.push("ColumnHeaders");t.setSticky(o);if(!n.getValue()){i.show("Select the file first!");return}else{var s=n.getFocusDomRef();var c=s.files[0];if(c&&window.FileReader){var l=new FileReader;l.onload=function(n){var i=n.target.result;var o=i.replace(/\n/g,",").split(",");var s;if(e._cIndex===1){s=20}else{s=16}var c=o.splice(0,s);while(o.length-1>0){var l={};var d={};var u=o.splice(0,s);for(var g=0;g<u.length;g++){l[c[g]]=u[g].trim();if(e._cIndex===1){switch(g){case 0:d["NOrder"]=l[c[g]];break;case 1:d["DType"]=l[c[g]];break;case 2:d["Sorg"]=l[c[g]];break;case 3:d["Dchnl"]=l[c[g]];break;case 4:d["Div"]=l[c[g]];break;case 5:d["SParty"]=l[c[g]];break;case 6:d["Cref"]=l[c[g]];break;case 7:d["Oreason"]=l[c[g]];break;case 8:d["Pterm"]=l[c[g]];break;case 9:d["Currency"]=l[c[g]];break;case 10:d["Pmethod"]=l[c[g]];break;case 11:d["HTID"]=l[c[g]];break;case 12:d["Htext"]=l[c[g]];break;case 13:d["Mat"]=l[c[g]];break;case 14:d["Quan"]=l[c[g]];break;case 15:d["CType"]=l[c[g]];break;case 16:d["Cvalue"]=l[c[g]];break;case 17:d["ITID"]=l[c[g]];break;case 18:d["Itext"]=l[c[g]];break;case 19:d["Bblock"]=l[c[g]];break}}else{switch(g){case 0:d["NOrder"]=l[c[g]];break;case 1:d["DType"]=l[c[g]];break;case 2:d["Sorg"]=l[c[g]];break;case 3:d["Dchnl"]=l[c[g]];break;case 4:d["Div"]=l[c[g]];break;case 5:d["SParty"]=l[c[g]];break;case 6:d["Cref"]=l[c[g]];break;case 7:d["Oreason"]=l[c[g]];break;case 8:d["Pterm"]=l[c[g]];break;case 9:d["Currency"]=l[c[g]];break;case 10:d["Pmethod"]=l[c[g]];break;case 11:d["Mat"]=l[c[g]];break;case 12:d["Quan"]=l[c[g]];break;case 13:d["CType"]=l[c[g]];break;case 14:d["Cvalue"]=l[c[g]];break;case 15:d["Bblock"]=l[c[g]];break}}}d["Memo"]=" ";r.push(d)}e._tModel.setData(a);t.setModel(e._tModel);var m=e.validateFileData();if(m){var h=e.byId("cUpload");h.setEnabled(true);e.byId("fileUploader").setEnabled(false);e.byId("tUpload").setEnabled(false);e.byId("rgM").setEnabled(false)}};l.readAsBinaryString(c)}}},validateFileData:function(){var e=this._tModel.getData();for(var t=0;t<e.trec.length;t++){if(e.trec[t].NOrder==="X"||e.trec[t].NOrder==="x"){if(this._cIndex===0&&e.trec[t].DType!=="CR"){var r=this.getView().getModel("i18n").getResourceBundle().getText("TemplateCError");l.error(r);return false}if(this._cIndex===1&&e.trec[t].DType!=="DR"){var a=this.getView().getModel("i18n").getResourceBundle().getText("TemplateDError");l.error(a);return false}}}return true},handleRefresh:function(){this._tModel.setData();this._rModel.setData();this._sMCount=0;this._oPromises=[];this._bPromises=[];this._msgArr=[];this._aObj=[];this._msgData.msgs={};this._rData.trec={};this.byId("cUpload").setEnabled(false);this.byId("tUpload").setEnabled(true);this.byId("fileUploader").setEnabled(true);this.byId("rgM").setEnabled(true);this.byId("fileUploader").clear();var e=sap.ui.getCore().byId("logBut");if(typeof e!=="undefined"){e.destroy()}},handlePost:function(){var e=this;var t=0;sap.ui.core.BusyIndicator.show();Promise.allSettled=function(r){r.forEach(function(r){r.then(function(a){t=t+1;e._sMCount=t;if(t===e._oPromises.length){e.promiseCompleted()}return r},function(a){t=t+1;if(t===e._oPromises.length){e.promiseCompleted()}return r})});return r};var r=[];if(this._cIndex===1){r=this.createDebitMemos()}if(this._cIndex===0){r=this.createCreditMemos()}var a=Promise.allSettled(r)},createDebitMemos:function(){var e=this._tModel.getData();var t={};var r={};var a=[];var n=0;var i=[];var o;var s=[];var c;var l="GRPID";for(var d=0;d<e.trec.length;d++){var u={};var g={};var m=[];var h={};var p=[];if(d!==0&&(e.trec[d].NOrder==="X"||e.trec[d].NOrder==="x")){t.to_Item=i;l=l+n;c=this.createDebitMemo(t,l);n=n+1;s.push(c);var t={};var r={};var a=[];var u={};var i=[];t.DebitMemoRequestType=e.trec[d].DType;t.SalesOrganization=e.trec[d].Sorg;t.DistributionChannel=e.trec[d].Dchnl;t.OrganizationDivision=e.trec[d].Div;t.SoldToParty=e.trec[d].SParty;t.SDDocumentReason=e.trec[d].Oreason;t.CustomerPaymentTerms=e.trec[d].Pterm;t.PaymentMethod=e.trec[d].Pmethod;t.TransactionCurrency=e.trec[d].Currency;t.PurchaseOrderByCustomer=e.trec[d].Cref;t.HeaderBillingBlockReason=e.trec[d].Bblock;r.LongTextID=e.trec[d].HTID;r.Language="E";r.LongText=e.trec[d].Htext;a.push(r);t.to_Text=a;u.Material=e.trec[d].Mat;u.RequestedQuantity=e.trec[d].Quan;h.Language="E";h.LongTextID=e.trec[d].ITID;h.LongText=e.trec[d].Itext;p.push(h);u.to_Text=p;g.ConditionType=e.trec[d].CType;g.ConditionRateValue=e.trec[d].Cvalue;m.push(g);u.to_PricingElement=m;i.push(u)}else{if(d==0){t.DebitMemoRequestType=e.trec[d].DType;t.SalesOrganization=e.trec[d].Sorg;t.DistributionChannel=e.trec[d].Dchnl;t.OrganizationDivision=e.trec[d].Div;t.SoldToParty=e.trec[d].SParty;t.SDDocumentReason=e.trec[d].Oreason;t.CustomerPaymentTerms=e.trec[d].Pterm;t.PaymentMethod=e.trec[d].Pmethod;t.TransactionCurrency=e.trec[d].Currency;t.HeaderBillingBlockReason=e.trec[d].Bblock;t.PurchaseOrderByCustomer=e.trec[d].Cref;r.LongTextID=e.trec[d].HTID;r.Language="E";r.LongText=e.trec[d].Htext;a.push(r);t.to_Text=a}u.Material=e.trec[d].Mat;u.RequestedQuantity=e.trec[d].Quan;h.Language="E";h.LongTextID=e.trec[d].ITID;h.LongText=e.trec[d].Itext;p.push(h);u.to_Text=p;g.ConditionType=e.trec[d].CType;g.ConditionRateValue=e.trec[d].Cvalue;m.push(g);u.to_PricingElement=m;i.push(u)}}t.to_Item=i;n=n+1;l=l+n;c=this.createDebitMemo(t,l);s.push(c);return s},createDebitMemo:function(e,t){var r=this._dModel;var a=this;var n=new Promise(function(n,i){r.create("/A_DebitMemoRequest",e,{success:function(t){var r={};r["Mtype"]="Success";r["Msg"]="Debit memo request is created with"+" "+t.DebitMemoRequest;r["DebitMemoNo"]=t.DebitMemoRequest;r["eTag"]=t.__metadata.etag;a._msgArr.push(r);var i=" ";a.updateMemo(t,e,i);n()},error:function(t){var r={};r["Mtype"]="Error";r["Msg"]=t.responseText;a._msgArr.push(r);var n="X";a.updateMemo(t,e,n);i()},groupId:t})});this._oPromises.push(n);return n},promiseCompleted:function(){this._rModel.setData(this._rData);var e=this;var t=0;Promise.allSettled=function(r){r.forEach(function(r){r.then(function(a){t=t+1;if(t===e._bPromises.length){sap.ui.core.BusyIndicator.hide();e.removeBlockCompleted()}return r},function(a){t=t+1;if(t===e._bPromises.length){sap.ui.core.BusyIndicator.hide();e.removeBlockCompleted()}return r})});return r};if(this._sMCount>0){var r=this.removeBillingBlock();var a=Promise.allSettled(r)}else{this.displayLog();sap.ui.core.BusyIndicator.hide()}},handleMessagePopoverPress:function(e){g.toggle(e.getSource())},memoSelected:function(){var e=this.byId("rgM");var t=e.getSelectedIndex();if(t===1){this._cmF.destroy();var r=this.byId("myContainer");var a=sap.ui.xmlfragment(this.createId("dmF"),"CreditDebit.UploadCreditDebitMemo.view.DebitMemo",this);this._dmF=a;r.addContent(a);this._cIndex=t}else{this._dmF.destroy();var r=this.byId("myContainer");var a=sap.ui.xmlfragment(this.createId("cmF"),"CreditDebit.UploadCreditDebitMemo.view.CreditMemo",this);this._cmF=a;r.addContent(a);this._cIndex=t}},createCreditMemos:function(){var e=this._tModel.getData();var t={};var r=[];var a;var n=[];var i;var o="GRPID";var s=0;for(var c=0;c<e.trec.length;c++){var l={};var d={};var u=[];if(c!==0&&(e.trec[c].NOrder==="X"||e.trec[c].NOrder==="x")){t.to_Item=r;o=o+s;i=this.createCreditMemo(t,o);s=s+1;n.push(i);var t={};var l={};var r=[];t.CreditMemoRequestType=e.trec[c].DType;t.SalesOrganization=e.trec[c].Sorg;t.DistributionChannel=e.trec[c].Dchnl;t.OrganizationDivision=e.trec[c].Div;t.SoldToParty=e.trec[c].SParty;t.SDDocumentReason=e.trec[c].Oreason;t.CustomerPaymentTerms=e.trec[c].Pterm;t.PaymentMethod=e.trec[c].Pmethod;t.TransactionCurrency=e.trec[c].Currency;t.PurchaseOrderByCustomer=e.trec[c].Cref;t.HeaderBillingBlockReason=e.trec[c].Bblock;l.Material=e.trec[c].Mat;l.RequestedQuantity=e.trec[c].Quan;d.ConditionType=e.trec[c].CType;d.ConditionRateValue=e.trec[c].Cvalue;u.push(d);l.to_PricingElement=u;r.push(l)}else{if(c==0){t.CreditMemoRequestType=e.trec[c].DType;t.SalesOrganization=e.trec[c].Sorg;t.DistributionChannel=e.trec[c].Dchnl;t.OrganizationDivision=e.trec[c].Div;t.SoldToParty=e.trec[c].SParty;t.SDDocumentReason=e.trec[c].Oreason;t.CustomerPaymentTerms=e.trec[c].Pterm;t.PaymentMethod=e.trec[c].Pmethod;t.TransactionCurrency=e.trec[c].Currency;t.PurchaseOrderByCustomer=e.trec[c].Cref;t.HeaderBillingBlockReason=e.trec[c].Bblock}l.Material=e.trec[c].Mat;l.RequestedQuantity=e.trec[c].Quan;d.ConditionType=e.trec[c].CType;d.ConditionRateValue=e.trec[c].Cvalue;u.push(d);l.to_PricingElement=u;r.push(l)}}t.to_Item=r;s=s+1;o=o+s;i=this.createCreditMemo(t,o);n.push(i);return n},createCreditMemo:function(e,t){var r=this._cModel;var a=this;var n=new Promise(function(n,i){r.create("/A_CreditMemoRequest",e,{success:function(t){var r={};r["Mtype"]="Success";r["Msg"]="Credit memo request is created with"+" "+t.CreditMemoRequest;a._msgArr.push(r);var i=" ";a.updateMemo(t,e,i);n()},error:function(t){var r={};r["Mtype"]="Error";r["Msg"]=t.responseText;a._msgArr.push(r);var n="X";a.updateMemo(t,e,n);i()},groupId:t})});this._oPromises.push(n);return n},removeBillingBlock:function(){var e=[];var t={trec:e};t=this._rModel.getData();if(this._cIndex===1){var r=this._dModel}else{var a=this._cModel}var n="GID";var i=[];var o=this;for(var s=0;s<t.trec.length;s++){if((t.trec[s].NOrder==="X"||t.trec[s].NOrder==="x")&&t.trec[s].Memo!=" "){n=n+s;var c={};var l=t.trec[s].Etag;var d=t.trec[s].Memo;c.HeaderBillingBlockReason=t.trec[s].Bblock;if(this._cIndex===1){var u=new Promise(function(e,t){var a=r.createKey("/A_DebitMemoRequest",{DebitMemoRequest:d});r.update(a,c,{success:function(t){var r={};e()},error:function(e){var r={};t()},eTag:l,groupId:n})})}else{var u=new Promise(function(e,t){var r=a.createKey("/A_CreditMemoRequest",{CreditMemoRequest:d});a.update(r,c,{success:function(t){var r={};e()},error:function(e){var r={};t()},eTag:l,groupId:n})})}i.push(u)}}this._bPromises=i;return i},removeBlockCompleted:function(){this.displayLog()},displayLog:function(){var e;if(this._cIndex===0){e=this.byId(sap.ui.core.Fragment.createId("cmF","memoTable"))}if(this._cIndex===1){e=this.byId(sap.ui.core.Fragment.createId("dmF","memoTable"))}this._rData.trec=this._aObj;this._msgData.msgs=this._msgArr;e.setModel(this._rModel);var t=new s({type:"{type}",title:"{title}",activeTitle:"{active}",description:"{description}",subtitle:"{subtitle}",counter:"{counter}"});g=new o({items:{path:"/",template:t},activeTitlePress:function(){}});var r=0;var a=0;var n=[];for(var i=0;i<this._msgArr.length;i++){var l={};if(this._msgArr[i].Mtype=="Success"){l["type"]=this._msgArr[i].Mtype;l["title"]="Success Message";l["active"]=false;l["description"]=this._msgArr[i].Msg;if(this._cIndex===1){l["subtitle"]=this.getView().getModel("i18n").getResourceBundle().getText("sDMsg")}else{l["subtitle"]=this.getView().getModel("i18n").getResourceBundle().getText("sCMsg")}r=r+1;l["conunter"]=r}else{l["type"]=this._msgArr[i].Mtype;l["title"]="Error Message";l["active"]=true;l["description"]=this._msgArr[i].Msg;if(this._cIndex===1){l["subtitle"]=this.getView().getModel("i18n").getResourceBundle().getText("eDMsg")}else{l["subtitle"]=this.getView().getModel("i18n").getResourceBundle().getText("eCMsg")}a=a+1;l["conunter"]=r}n.push(l)}var d=new sap.ui.model.json.JSONModel;d.setData(n);this.getView().setModel(d);var u=new c({id:"logBut",text:"Log",type:"Emphasized",width:"6rem"});u.addDependent(g);u.attachPress(this.handleMessagePopoverPress);var m=this.getView().byId("oToolBar");m.addContent(u);this.byId("cUpload").setEnabled(false);this.byId("tUpload").setEnabled(false);this.byId("fileUploader").setEnabled(false)},updateMemo:function(e,t,r){var a={};if(r!=="X"){a["NOrder"]="X";if(this._cIndex===1){a["Memo"]=e.DebitMemoRequest;a["DType"]=e.DebitMemoRequestType}else{a["Memo"]=e.CreditMemoRequest;a["DType"]=e.CreditMemoRequestType}a["Etag"]=e.__metadata.etag;a["Sorg"]=e.SalesOrganization;a["Dchnl"]=e.DistributionChannel;a["Div"]=e.OrganizationDivision;a["SParty"]=e.SoldToParty;a["Cref"]=e.PurchaseOrderByCustomer;a["Oreason"]=e.SDDocumentReason;a["Pterm"]=e.CustomerPaymentTerms;a["Currency"]=e.TransactionCurrency;a["Pmethod"]=e.PaymentMethod;a["Bblock"]=t.HeaderBillingBlockReason;if(this._cIndex===1){a["HTID"]=t.to_Text[0].LongTextID;a["Htext"]=t.to_Text[0].LongText}for(var n=0;n<t.to_Item.length;n++){a["Mat"]=t.to_Item[n].Material;a["Quan"]=t.to_Item[n].RequestedQuantity;a["CType"]=t.to_Item[n].to_PricingElement[0].ConditionType;a["Cvalue"]=t.to_Item[n].to_PricingElement[0].ConditionRateValue;if(this._cIndex===1){a["ITID"]=t.to_Item[n].to_Text[0].LongTextID;a["Itext"]=t.to_Item[n].to_Text[0].LongText}this._aObj.push(a);if(n!==t.to_Item.length-1){var a={};if(this._cIndex===1){a["Memo"]=e.DebitMemoRequest;a["DType"]=e.DebitMemoRequestType}else{a["Memo"]=e.CreditMemoRequest;a["DType"]=e.CreditMemoRequestType}a["Etag"]=e.__metadata.etag;a["Sorg"]=e.SalesOrganization;a["Dchnl"]=e.DistributionChannel;a["Div"]=e.OrganizationDivision;a["SParty"]=e.SoldToParty;a["Cref"]=e.PurchaseOrderByCustomer;a["Oreason"]=e.SDDocumentReason;a["Pterm"]=e.CustomerPaymentTerms;a["Currency"]=e.TransactionCurrency;a["Pmethod"]=e.PaymentMethod;a["Bblock"]=t.HeaderBillingBlockReason;if(this._cIndex===1){a["HTID"]=t.to_Text[0].LongTextID;a["Htext"]=t.to_Text[0].LongText}}}}else{a["Memo"]=" ";a["NOrder"]="X";if(this._cIndex===1){a["DType"]=t.DebitMemoRequestType}else{a["DType"]=t.CreditMemoRequestType}a["Sorg"]=t.SalesOrganization;a["Dchnl"]=t.DistributionChannel;a["Div"]=t.OrganizationDivision;a["SParty"]=t.SoldToParty;a["Cref"]=t.PurchaseOrderByCustomer;a["Oreason"]=t.SDDocumentReason;a["Pterm"]=t.CustomerPaymentTerms;a["Currency"]=t.TransactionCurrency;a["Pmethod"]=t.PaymentMethod;a["Bblock"]=t.HeaderBillingBlockReason;if(this._cIndex===1){a["HTID"]=t.to_Text[0].LongTextID;a["Htext"]=t.to_Text[0].LongText}for(var n=0;n<t.to_Item.length;n++){a["Mat"]=t.to_Item[n].Material;a["Quan"]=t.to_Item[n].RequestedQuantity;a["CType"]=t.to_Item[n].to_PricingElement[0].ConditionType;a["Cvalue"]=t.to_Item[n].to_PricingElement[0].ConditionRateValue;if(this._cIndex===1){a["ITID"]=t.to_Item[n].to_Text[0].LongTextID;a["Itext"]=t.to_Item[n].to_Text[0].LongText}this._aObj.push(a);if(n!==t.to_Item.length-1){var a={};if(this._cIndex===1){a["DType"]=t.DebitMemoRequestType}else{a["DType"]=t.CreditMemoRequestType}a["Sorg"]=t.SalesOrganization;a["Dchnl"]=t.DistributionChannel;a["Div"]=t.OrganizationDivision;a["SParty"]=t.SoldToParty;a["Cref"]=t.PurchaseOrderByCustomer;a["Oreason"]=t.SDDocumentReason;a["Pterm"]=t.CustomerPaymentTerms;a["Currency"]=t.TransactionCurrency;a["Pmethod"]=t.PaymentMethod;a["Bblock"]=t.HeaderBillingBlockReason;if(this._cIndex===1){a["HTID"]=t.to_Text[0].LongTextID;a["Htext"]=t.to_Text[0].LongText}}}}this._rData.trec=this._aObj},downloadData:function(){var e=[];var t;var r={trec:e};var r=this._rModel.getData();var a;if(typeof r==="undefined"){a=true}else{if(Object.keys(r).length===0){a=true}}if(a){var n=this.getView().getModel("i18n").getResourceBundle().getText("oTableNoDataText");sap.m.MessageBox.warning(n)}else{var i=new Date;var o=i.getUTCDate()+"-"+(i.getUTCMonth()+1)+"-"+i.getUTCFullYear()+" "+i.getUTCHours()+":"+i.getUTCMinutes()+":"+i.getUTCSeconds();var s="Memo_".concat(o);if(this._cIndex===0){var c=new sap.ui.core.util.Export({exportType:new u({separatorChar:",",charset:"utf-8"}),models:this._rModel,rows:{path:"/trec"},columns:[{name:this.getView().getModel("i18n").getResourceBundle().getText("NewOrderTitle"),template:{content:"{NOrder}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("DocTypeE"),template:{content:"{DType}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("SalesOrgE"),template:{content:"{Sorg}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("DistChannelE"),template:{content:"{Dchnl}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("Division"),template:{content:"{Div}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("SoldParty"),template:{content:"{SParty}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("CReferenceE"),template:{content:"{Cref}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("Oreason"),template:{content:"{Oreason}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("PTermE"),template:{content:"{Pterm}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("Currency"),template:{content:"{Currency}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("PMethodE"),template:{content:"{Pmethod}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("Mat"),template:{content:"{Mat}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("Quan"),template:{content:"{Quan}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("CType"),template:{content:"{CType}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("CValueE"),template:{content:"{Cvalue}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("Bblock"),template:{content:"{Bblock}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("CreditMemo"),template:{content:"{Memo}"}}]})}else{var c=new sap.ui.core.util.Export({exportType:new u({separatorChar:",",charset:"utf-8"}),models:this._rModel,rows:{path:"/trec"},columns:[{name:this.getView().getModel("i18n").getResourceBundle().getText("NewOrderTitle"),template:{content:"{NOrder}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("DocTypeE"),template:{content:"{DType}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("SalesOrgE"),template:{content:"{Sorg}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("DistChannelE"),template:{content:"{Dchnl}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("Division"),template:{content:"{Div}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("SoldParty"),template:{content:"{SParty}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("CReferenceE"),template:{content:"{Cref}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("Oreason"),template:{content:"{Oreason}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("PTermE"),template:{content:"{Pterm}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("Currency"),template:{content:"{Currency}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("PMethodE"),template:{content:"{Pmethod}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("Mat"),template:{content:"{Mat}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("Quan"),template:{content:"{Quan}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("HTextID"),template:{content:"{HTID}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("HText"),template:{content:"{Htext}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("CType"),template:{content:"{CType}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("CValueE"),template:{content:"{Cvalue}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("ITextID"),template:{content:"{ITID}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("IText"),template:{content:"{Itext}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("Bblock"),template:{content:"{Bblock}"}},{name:this.getView().getModel("i18n").getResourceBundle().getText("DebitMemo"),template:{content:"{Memo}"}}]})}c.saveFile(s).catch(function(e){var t=this.getView().getModel("i18n").getResourceBundle().getText("eText");l.error(t+e)}).then(function(){c.destroy()})}},createColumns:function(){var e=[];e.push({label:"Document Type",property:"DType",width:10,type:"string"});e.push({label:"Sales Organization",property:"Sorg",width:10,type:"string"});e.push({label:"Distrubution Channel",property:"Dchnl",width:10,type:"string"});e.push({label:"Division",property:"Div",width:10,type:"string"});e.push({label:"Sold To Party",property:"SParty",width:10,type:"string"});e.push({label:"Customer Reference",property:"Cref",width:10,type:"string"});e.push({label:"Order Reason",property:"Oreason",width:10,type:"string"});e.push({label:"Payment Term",property:"Pterm",width:10,type:"string"});e.push({label:"Currency",property:"Currency",width:10,type:"string"});e.push({label:"Payment Method",property:"Pmethod",width:10,type:"string"});e.push({label:"Material",property:"Mat",width:10,type:"string"});e.push({label:"Quanitity",property:"Quan",width:10,type:"string"});e.push({label:"Condition Type",property:"Ctype",width:10,type:"string"});e.push({label:"Condition Value",property:"Cvalue",width:10,type:"string"});e.push({label:"Billing Block",property:"Bblock",width:10,type:"string"});e.push({label:"Credit Memo Request",property:"Memo",width:10,type:"string"});return e}})});